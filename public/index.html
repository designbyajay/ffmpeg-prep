<!DOCTYPE html>

<head>
    <script>
        let rickRollResponse = null

        const getRickRoll = async () => {
            const { body } = await fetch('/makestream')
            const reader = body.getReader()

            const getChunk = async function* () {
                const { value, done } = await reader.read()
                if (done) return;
                yield value;
            }

            for await (const chunk of getChunk()) {
                console.log(chunk.toString())
            }

            const v = document.getElementById('stream')
            v.src = '/example'
            v.muted = true
            v.controls = true
            // v.play();
        }
    </script>
</head>

<body>
    <button onclick="getRickRoll()">hibob</button>
    <video id="stream" type="video/mp4">
    </video>
</body>